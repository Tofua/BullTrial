<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Power BI Embed</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/powerbi-client/2.19.1/powerbi.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      height: 100vh;
      overflow: hidden;
    }
    #reportContainer {
      width: 100%;
      height: 100%;
      border: none;
    }
    .error {
      color: #721c24;
      background-color: #f8d7da;
      border: 1px solid #f5c6cb;
      padding: 10px;
      margin: 10px;
      border-radius: 4px;
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      z-index: 100;
    }
  </style>
</head>
<body>
  <div id="errorMessage" style="display: none;" class="error"></div>
  <div id="reportContainer"></div>

  <script>
    document.addEventListener("DOMContentLoaded", function () {
      // Hardcoded token
      const accessToken = "eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6IkpETmFfNGk0cjdGZ2lnTDNzSElsSTN4Vi1JVSIsImtpZCI6IkpETmFfNGk0cjdGZ2lnTDNzSElsSTN4Vi1JVSJ9.eyJhdWQiOiJodHRwczovL2FuYWx5c2lzLndpbmRvd3MubmV0L3Bvd2VyYmkvYXBpIiwiaXNzIjoiaHR0cHM6Ly9zdHMud2luZG93cy5uZXQvMzc3MzJiOTYtNDk3NC00ZGYwLWFlM2QtM2Y1YmFiNWY5NTY0LyIsImlhdCI6MTc0MjM5NDA1MywibmJmIjoxNzQyMzk0MDUzLCJleHAiOjE3NDIzOTk2NjYsImFjY3QiOjAsImFjciI6IjEiLCJhaW8iOiJBWFFBaS84WkFBQUEyenVCYzR3NXp5Y21adk04ck5iRXA1WGc0Mk1OV3RCNWRnVXhlZk1BZW5Vb0V5bitUZ1JBOEJDMmZOem5lL0lQWGIxUWU3WlVBSXRWdmxhdmJXek5SZ2pUUVdVN1pjZklrR0RtZXhsa0YrajFEcENzeUZxQ0RrMGdJc0xwOUtJQ25SQTVucDdORmJYQ2JvQmlNNXlhY3c9PSIsImFtciI6WyJwd2QiLCJtZmEiXSwiYXBwaWQiOiI4NzFjMDEwZi01ZTYxLTRmYjEtODNhYy05ODYxMGE3ZTkxMTAiLCJhcHBpZGFjciI6IjAiLCJmYW1pbHlfbmFtZSI6ImFwYW1wYSIsImdpdmVuX25hbWUiOiJ0b2Z1bm1pIiwiaWR0eXAiOiJ1c2VyIiwiaXBhZGRyIjoiODQuNjguMjE0LjcwIiwibmFtZSI6InRvZnVubWkgYXBhbXBhIiwib2lkIjoiMjcwMjU4MWYtMjI2Yi00NTI0LWJjODgtZDk1NzlkYmM0MDFjIiwicHVpZCI6IjEwMDMyMDAzOTQzNUIyQTMiLCJyaCI6IjEuQVJNQmxpdHpOM1JKOEUydVBUOWJxMS1WWkFrQUFBQUFBQUFBd0FBQUFBQUFBQUFUQWZjVEFRLiIsInNjcCI6InVzZXJfaW1wZXJzb25hdGlvbiIsInNpZCI6IjAwMmZmMTg5LTU3MDUtNTEzMy0wNjJjLWIxZGE5MWNlYTkxNiIsInNpZ25pbl9zdGF0ZSI6WyJrbXNpIl0sInN1YiI6InRGeVJUb2lwMnNQMjNyMFZYMWgtU29Qa3piWWp6S1Y4bUN4NndWQmdxLVUiLCJ0aWQiOiIzNzczMmI5Ni00OTc0LTRkZjAtYWUzZC0zZjViYWI1Zjk1NjQiLCJ1bmlxdWVfbmFtZSI6InRvZnVubWlhcGFtcGFASG9zdERhdGEub25taWNyb3NvZnQuY29tIiwidXBuIjoidG9mdW5taWFwYW1wYUBIb3N0RGF0YS5vbm1pY3Jvc29mdC5jb20iLCJ1dGkiOiJvWjAwbUx5VkFVeWVKYVp3YTdVZ0FBIiwidmVyIjoiMS4wIiwid2lkcyI6WyI2MmU5MDM5NC02OWY1LTQyMzctOTE5MC0wMTIxNzcxNDVlMTAiLCJiNzlmYmY0ZC0zZWY5LTQ2ODktODE0My03NmIxOTRlODU1MDkiXSwieG1zX2lkcmVsIjoiMSAxNiIsInhtc19wbCI6ImVuIn0.QG9CPhatJvQlTYxuX60bcjJCvCGiHnvvbJawGCS67ujJbfvEGhUaaIKLWDW5rYn8pYRvTWvxziK8ththWMqr0mDlYvGbG2f80cMarwr4HeLbNXCMNvOfgq89QZy_c4cRXcbv3P7EQs8Dmb8l3IO9ILYGb53-rh4LK36d8wnsSB4E_gjmm4tTm50MfHopcQrJIiY8-7ruujeDZlExQBm6gbziDnUMU4IX1poRjp49gByglZlmNSipSzQyMQ8Dq8RRfe38VoHez6UP_VcFNpLc0MNBmxXjtP9Tm4HNse-xFSoHC3KFc-bAp1x25YaGGHswZzpRP6gsMxhcUIZh1HPp9w";
      const reportId = "782913b3-f792-4f84-bc87-d46092f64932";
      
      // Get models
      const models = window['powerbi-client'].models;
      
      // Configure settings
      const embedConfiguration = {
        type: "report",
        id: reportId,
        embedUrl: `https://app.powerbi.com/reportEmbed?reportId=${reportId}`,
        tokenType: models.TokenType.Aad,
        accessToken: accessToken,
        permissions: models.Permissions.Read,
        settings: {
          panes: {
            filters: { visible: true },
            pageNavigation: { visible: true }
          },
          bars: {
            statusBar: { visible: true }
          }
        }
      };
      
      // Display errors
      function showError(message) {
        const errorElement = document.getElementById('errorMessage');
        errorElement.style.display = 'block';
        errorElement.textContent = message;
        console.error(message);
      }

      try {
        // Embed the report
        const reportContainer = document.getElementById('reportContainer');
        const report = powerbi.embed(reportContainer, embedConfiguration);
        
        // Add event listeners
        report.on("loaded", function() {
          console.log("Report loaded successfully");
        });
        
        report.on("rendered", function() {
          console.log("Report rendered successfully");
        });
        
        report.on("error", function(event) {
          const errorDetails = event.detail;
          showError(`Error: ${errorDetails.message} - ${errorDetails.detailedMessage} (Code: ${errorDetails.errorCode})`);
          
          console.error("Error details:", errorDetails);
        });
      } catch (error) {
        showError(`Initialization error: ${error.message}`);
      }
    });
  </script>
</body>
</html>
