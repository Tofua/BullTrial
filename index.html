<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Power BI Embed</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/powerbi-client/2.19.1/powerbi.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      height: 100vh;
      overflow: hidden;
    }
    #reportContainer {
      width: 100%;
      height: 100%;
      border: none;
    }
    .error {
      color: #721c24;
      background-color: #f8d7da;
      border: 1px solid #f5c6cb;
      padding: 10px;
      margin: 10px;
      border-radius: 4px;
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      z-index: 100;
    }
  </style>
</head>
<body>
  <div id="errorMessage" style="display: none;" class="error"></div>
  <div id="reportContainer"></div>

  <script>
    document.addEventListener("DOMContentLoaded", function () {
      // Hardcoded token
      const accessToken = "eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6IkpETmFfNGk0cjdGZ2lnTDNzSElsSTN4Vi1JVSIsImtpZCI6IkpETmFfNGk0cjdGZ2lnTDNzSElsSTN4Vi1JVSJ9.eyJhdWQiOiJodHRwczovL2FuYWx5c2lzLndpbmRvd3MubmV0L3Bvd2VyYmkvYXBpIiwiaXNzIjoiaHR0cHM6Ly9zdHMud2luZG93cy5uZXQvMzc3MzJiOTYtNDk3NC00ZGYwLWFlM2QtM2Y1YmFiNWY5NTY0LyIsImlhdCI6MTc0MjQwNTQyMywibmJmIjoxNzQyNDA1NDIzLCJleHAiOjE3NDI0MTExMjIsImFjY3QiOjAsImFjciI6IjEiLCJhaW8iOiJBV1FBbS84WkFBQUFxbTVSeXNlbVVPWDlNTDA2Zi9EZXJBVlpXai9LZk1tc3NZOWt6b2lKY1dVL1g3MDBOVGFMaHJSTTBVK1c5ODg4bkxyaXZSKzVkaFlsK2VzYkZ6ajkzUFFkL0dTYUF2Yit5Yml0c1ZZS0U1V1VPVzJqWXIyb1J1WjBJcG5RRnBtZyIsImFtciI6WyJwd2QiLCJtZmEiXSwiYXBwaWQiOiI3MzA5NmUyYS1mZGZhLTRhZDAtODg0Yi03NWJjMTljMjUwY2EiLCJhcHBpZGFjciI6IjEiLCJmYW1pbHlfbmFtZSI6ImFwYW1wYSIsImdpdmVuX25hbWUiOiJ0b2Z1bm1pIiwiaWR0eXAiOiJ1c2VyIiwiaXBhZGRyIjoiODQuNjguMjE0LjcwIiwibmFtZSI6InRvZnVubWkgYXBhbXBhIiwib2lkIjoiMjcwMjU4MWYtMjI2Yi00NTI0LWJjODgtZDk1NzlkYmM0MDFjIiwicHVpZCI6IjEwMDMyMDAzOTQzNUIyQTMiLCJyaCI6IjEuQVJNQmxpdHpOM1JKOEUydVBUOWJxMS1WWkFrQUFBQUFBQUFBd0FBQUFBQUFBQUFUQWZjVEFRLiIsInNjcCI6IkFwcC5SZWFkLkFsbCBDb25uZWN0aW9uLlJlYWQuQWxsIENvbm5lY3Rpb24uUmVhZFdyaXRlLkFsbCBDb25uZWN0aW9uLlJlc2hhcmUuQWxsIENvbnRlbnQuQ3JlYXRlIERhdGFzZXQuUmVhZFdyaXRlLkFsbCBHYXRld2F5LlJlYWQuQWxsIEdhdGV3YXkuUmVhZFdyaXRlLkFsbCBQYWdpbmF0ZWRSZXBvcnQuUmVhZFdyaXRlLkFsbCBSZXBvcnQuUmVhZFdyaXRlLkFsbCBVc2VyRGF0YUZ1bmN0aW9uLkV4ZWN1dGUuQWxsIFVzZXJEYXRhRnVuY3Rpb24uUmVhZC5BbGwgVXNlckRhdGFGdW5jdGlvbi5SZWFkV3JpdGUuQWxsIFVzZXJTdGF0ZS5SZWFkV3JpdGUuQWxsIiwic2lkIjoiMDAyZmYxODktNTcwNS01MTMzLTA2MmMtYjFkYTkxY2VhOTE2Iiwic2lnbmluX3N0YXRlIjpbImttc2kiXSwic3ViIjoidEZ5UlRvaXAyc1AyM3IwVlgxaC1Tb1BremJZanpLVjhtQ3g2d1ZCZ3EtVSIsInRpZCI6IjM3NzMyYjk2LTQ5NzQtNGRmMC1hZTNkLTNmNWJhYjVmOTU2NCIsInVuaXF1ZV9uYW1lIjoidG9mdW5taWFwYW1wYUBIb3N0RGF0YS5vbm1pY3Jvc29mdC5jb20iLCJ1cG4iOiJ0b2Z1bm1pYXBhbXBhQEhvc3REYXRhLm9ubWljcm9zb2Z0LmNvbSIsInV0aSI6ImtIVDlRbU85VWsyUXNVMjZhYzhxQUEiLCJ2ZXIiOiIxLjAiLCJ3aWRzIjpbIjYyZTkwMzk0LTY5ZjUtNDIzNy05MTkwLTAxMjE3NzE0NWUxMCIsImI3OWZiZjRkLTNlZjktNDY4OS04MTQzLTc2YjE5NGU4NTUwOSJdLCJ4bXNfaWRyZWwiOiIxIDEwIiwieG1zX3BsIjoiZW4ifQ.ULWEiHUqlwDSY_JfHSrnuQ_WWql4Jrx-x-Id8JLJCD3Qm0CSmu0-gJnE4Ms-L69oxLiOKX1OD6DtqYyEUsInPyxu-mqkiytn6D20PamSO_r9WW53vypKZ4s6nhF3M9N-xSCFnhq2pWSaGceQNgnOLDxPMTq_j_TZJynDSQF-JrVnxyggs9LpYS-J2FG12W9qlqdOLoK8zC3I1xKbvJhq_a2t5NAMvKsJNa6qLtAW6Mbx9QrwRDG8ScszmzcnR8Lw23ozxvSScj_Gckak_I3GXZwzMd73dUMhrUIVlFdRjHvaxewgg8Cve45vRD0C1coQ3kR64cD3Nj7WGnhAT_5jqg";
      const reportId = "782913b3-f792-4f84-bc87-d46092f64932";
      
      // Get models
      const models = window['powerbi-client'].models;
      
      // Configure settings
      const embedConfiguration = {
        type: "report",
        id: reportId,
        embedUrl: `https://app.powerbi.com/reportEmbed?reportId=${reportId}`,
        tokenType: models.TokenType.Aad,
        accessToken: accessToken,
        permissions: models.Permissions.Read,
        settings: {
          panes: {
            filters: { visible: true },
            pageNavigation: { visible: true }
          },
          bars: {
            statusBar: { visible: true }
          }
        }
      };
      
      // Display errors
      function showError(message) {
        const errorElement = document.getElementById('errorMessage');
        errorElement.style.display = 'block';
        errorElement.textContent = message;
        console.error(message);
      }

      try {
        // Embed the report
        const reportContainer = document.getElementById('reportContainer');
        const report = powerbi.embed(reportContainer, embedConfiguration);
        
        // Add event listeners
        report.on("loaded", function() {
          console.log("Report loaded successfully");
        });
        
        report.on("rendered", function() {
          console.log("Report rendered successfully");
        });
        
        report.on("error", function(event) {
          const errorDetails = event.detail;
          showError(`Error: ${errorDetails.message} - ${errorDetails.detailedMessage} (Code: ${errorDetails.errorCode})`);
          
          console.error("Error details:", errorDetails);
        });
      } catch (error) {
        showError(`Initialization error: ${error.message}`);
      }
    });
  </script>
</body>
</html>
